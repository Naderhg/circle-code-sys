<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New User - CIRCLE CODE</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Sidebar Navigation -->
    <div class="sidebar">
        <div class="logo">
            <div class="logo-icon"><i class="fas fa-code"></i></div>
            <div class="logo-text">
                <h2>CIRCLE CODE</h2>
                <p>From Code to Complete Solutions</p>
            </div>
        </div>

        <div class="user-welcome">
            <div class="user-avatar">M</div>
            <span>Welcome, Admin User</span>
        </div>

        <ul class="nav-menu">
            <li>
                <a href="index.html"><i class="fas fa-th-large"></i> Dashboard</a>
            </li>
            <li>
                <a href="sellers.html"><i class="fas fa-store"></i> Merchants</a>
            </li>
            <li>
                <a href="agents.html"><i class="fas fa-user-tie"></i> Agents</a>
            </li>
            <li>
                <a href="shipments.html"><i class="fas fa-shipping-fast"></i> Shipments</a>
            </li>
            <li>
                <a href="zones.html"><i class="fas fa-map-marked-alt"></i> Zones</a>
            </li>
            <li>
                <a href="wallet.html"><i class="fas fa-wallet"></i> Wallet</a>
            </li>
            <li class="active">
                <a href="users.html"><i class="fas fa-users"></i> All Users</a>
            </li>
            <li>
                <a href="settings.html"><i class="fas fa-cog"></i> Settings</a>
            </li>
            <li>
                <a href="reports.html"><i class="fas fa-chart-line"></i> Reports</a>
            </li>
        </ul>

        <div class="logout">
            <a href="#"><i class="fas fa-sign-out-alt"></i> Log Out</a>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="top-bar">
            <div class="page-title">
                <h1>New User</h1>
            </div>
            <div class="top-bar-right">
                <button class="notification-btn"><i class="fas fa-bell"></i></button>
                <button class="theme-toggle-btn"><i class="fas fa-moon"></i></button>
                <button class="profile-btn"><i class="fas fa-user-circle"></i></button>
            </div>
        </div>

        <!-- User Form -->
        <div class="form-container">
            <form id="userForm" class="data-form">
                <div class="form-section">
                    <h3><i class="fas fa-user"></i> Basic Information</h3>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="userId">User ID</label>
                            <input type="text" id="userId" name="userId" class="form-control" placeholder="Auto-generated" disabled>
                        </div>
                        <div class="form-group">
                            <label for="joiningDate">Registration Date</label>
                            <input type="date" id="joiningDate" name="joiningDate" class="form-control" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="firstName">First Name</label>
                            <input type="text" id="firstName" name="firstName" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="lastName">Last Name</label>
                            <input type="text" id="lastName" name="lastName" class="form-control" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="email">Email Address</label>
                            <input type="email" id="email" name="email" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="phone">Phone Number</label>
                            <input type="tel" id="phone" name="phone" class="form-control" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="userRole">User Role</label>
                            <select id="userRole" name="userRole" class="form-control" required onchange="toggleRoleFields()">
                                <option value="">Select Role</option>
                                <option value="admin">Admin</option>
                                <option value="seller">Merchant/Seller</option>
                                <option value="agent">Delivery Agent</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="status">Status</label>
                            <select id="status" name="status" class="form-control" required>
                                <option value="active">Active</option>
                                <option value="pending">Pending</option>
                                <option value="inactive">Inactive</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="password">Password</label>
                            <input type="password" id="password" name="password" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="confirmPassword">Confirm Password</label>
                            <input type="password" id="confirmPassword" name="confirmPassword" class="form-control" required>
                        </div>
                    </div>
                </div>

                <!-- Admin-specific fields -->
                <div id="adminFields" class="role-specific-fields" style="display: none;">
                    <div class="form-section">
                        <h3><i class="fas fa-shield-alt"></i> Admin Information</h3>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="adminRole">Admin Role</label>
                                <select id="adminRole" name="adminRole" class="form-control">
                                    <option value="">Select Admin Role</option>
                                    <option value="superadmin">Super Admin</option>
                                    <option value="manager">Manager</option>
                                    <option value="support">Support Staff</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="department">Department</label>
                                <select id="department" name="department" class="form-control">
                                    <option value="">Select Department</option>
                                    <option value="operations">Operations</option>
                                    <option value="finance">Finance</option>
                                    <option value="support">Customer Support</option>
                                    <option value="it">IT</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="adminPermissions">Permissions</label>
                                <div class="checkbox-group">
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="permUsers" name="permissions[]" value="users">
                                        <label for="permUsers">Manage Users</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="permShipments" name="permissions[]" value="shipments">
                                        <label for="permShipments">Manage Shipments</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="permFinance" name="permissions[]" value="finance">
                                        <label for="permFinance">Financial Operations</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="permReports" name="permissions[]" value="reports">
                                        <label for="permReports">View Reports</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="permSettings" name="permissions[]" value="settings">
                                        <label for="permSettings">System Settings</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Merchant-specific fields -->
                <div id="sellerFields" class="role-specific-fields" style="display: none;">
                    <div class="form-section">
                        <h3><i class="fas fa-store"></i> Merchant Information</h3>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="businessName">Business Name</label>
                                <input type="text" id="businessName" name="businessName" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="businessType">Business Type</label>
                                <select id="businessType" name="businessType" class="form-control">
                                    <option value="">Select Business Type</option>
                                    <option value="electronics">Electronics</option>
                                    <option value="fashion">Fashion & Clothing</option>
                                    <option value="books">Books & Stationery</option>
                                    <option value="food">Food & Groceries</option>
                                    <option value="health">Health & Beauty</option>
                                    <option value="home">Home & Furniture</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="taxId">Tax ID / Business Registration Number</label>
                                <input type="text" id="taxId" name="taxId" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="contactPosition">Position</label>
                                <input type="text" id="contactPosition" name="contactPosition" class="form-control">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="website">Website (Optional)</label>
                                <input type="url" id="website" name="website" class="form-control">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Agent-specific fields -->
                <div id="agentFields" class="role-specific-fields" style="display: none;">
                    <div class="form-section">
                        <h3><i class="fas fa-user-tie"></i> Agent Information</h3>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="nationalId">National ID / Passport</label>
                                <input type="text" id="nationalId" name="nationalId" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="zone">Assigned Zone</label>
                                <select id="zone" name="zone" class="form-control">
                                    <option value="">Select Zone</option>
                                    <option value="downtown">Downtown</option>
                                    <option value="north">North District</option>
                                    <option value="east">East District</option>
                                    <option value="south">South District</option>
                                    <option value="west">West District</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="vehicleType">Vehicle Type</label>
                                <select id="vehicleType" name="vehicleType" class="form-control">
                                    <option value="">Select Vehicle Type</option>
                                    <option value="motorcycle">Motorcycle</option>
                                    <option value="car">Car</option>
                                    <option value="van">Van</option>
                                    <option value="bicycle">Bicycle</option>
                                    <option value="foot">On Foot</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="vehicleNumber">Vehicle Registration Number</label>
                                <input type="text" id="vehicleNumber" name="vehicleNumber" class="form-control">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="licenseNumber">Driving License Number</label>
                                <input type="text" id="licenseNumber" name="licenseNumber" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="emergencyContact">Emergency Contact</label>
                                <input type="text" id="emergencyContact" name="emergencyContact" class="form-control">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="emergencyPhone">Emergency Contact Phone</label>
                                <input type="tel" id="emergencyPhone" name="emergencyPhone" class="form-control">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Common fields for all roles -->
                <div class="form-section">
                    <h3><i class="fas fa-map-marker-alt"></i> Address Information</h3>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="addressLine1">Address Line 1</label>
                            <input type="text" id="addressLine1" name="addressLine1" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="addressLine2">Address Line 2 (Optional)</label>
                            <input type="text" id="addressLine2" name="addressLine2" class="form-control">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="city">City</label>
                            <input type="text" id="city" name="city" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="postalCode">Postal Code</label>
                            <input type="text" id="postalCode" name="postalCode" class="form-control">
                        </div>
                    </div>
                </div>



                <div class="form-section">
                    <h3><i class="fas fa-file-alt"></i> Additional Information</h3>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="notes">Additional Notes</label>
                            <textarea id="notes" name="notes" class="form-control" rows="3"></textarea>
                        </div>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-light" onclick="window.location.href='users.html'">Cancel</button>
                    <button type="submit" class="btn btn-primary">Create User</button>
                </div>
            </form>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Set default date to today
            document.getElementById('joiningDate').valueAsDate = new Date();
            
            // Get role from URL parameter
            const urlParams = new URLSearchParams(window.location.search);
            const roleParam = urlParams.get('role');
            const userId = urlParams.get('id');
            
            // If role is specified in URL, select it and show relevant fields
            if (roleParam) {
                const roleSelect = document.getElementById('userRole');
                roleSelect.value = roleParam;
                
                // Update page title and header based on role
                let pageTitle = 'New User';
                if (roleParam === 'admin') pageTitle = 'New Admin';
                else if (roleParam === 'seller') pageTitle = 'New Merchant';
                else if (roleParam === 'agent') pageTitle = 'New Agent';
                
                document.title = pageTitle + ' - CIRCLE CODE';
                document.querySelector('.page-title h1').textContent = pageTitle;
                
                // If editing an existing user
                if (userId) {
                    document.title = 'Edit ' + pageTitle.substring(4) + ' - CIRCLE CODE';
                    document.querySelector('.page-title h1').textContent = 'Edit ' + pageTitle.substring(4);
                    document.querySelector('.form-actions button[type="submit"]').textContent = 'Update ' + pageTitle.substring(4);
                    
                    // In a real application, you would fetch the user data using the ID
                    // and populate the form fields
                    console.log('Editing user with ID:', userId);
                    
                    // For demo purposes, we'll just show a message
                    alert('Loading user data for ID: ' + userId + '\nIn a real application, this would fetch the user data from the server.');
                }
                
                // Show fields for the selected role
                toggleRoleFields();
            }
            
            // Form submission handler
            document.getElementById('userForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Validate password match
                const password = document.getElementById('password').value;
                const confirmPassword = document.getElementById('confirmPassword').value;
                
                if (password !== confirmPassword) {
                    alert('Passwords do not match!');
                    return;
                }
                
                // Collect form data
                const formData = new FormData(this);
                const userData = {};
                
                formData.forEach((value, key) => {
                    userData[key] = value;
                });
                
                // In a real application, you would send this data to your backend
                console.log('User data to be submitted:', userData);
                
                // Show success message
                const roleSelect = document.getElementById('userRole');
                const role = roleSelect.options[roleSelect.selectedIndex].text;
                
                const isNewUser = !userId;
                const actionText = isNewUser ? 'created' : 'updated';
                
                alert(role + ' ' + actionText + ' successfully!');
                
                // Redirect based on role
                if (roleParam === 'seller') {
                    window.location.href = 'sellers.html';
                } else if (roleParam === 'agent') {
                    window.location.href = 'agents.html';
                } else {
                    window.location.href = 'users.html';
                }
            });
            
            // Initialize role fields
            toggleRoleFields();
        });
        
        // Function to toggle role-specific fields
        function toggleRoleFields() {
            const selectedRole = document.getElementById('userRole').value;
            
            // Hide all role-specific fields
            document.querySelectorAll('.role-specific-fields').forEach(field => {
                field.style.display = 'none';
            });
            
            // Show fields for the selected role
            if (selectedRole === 'admin') {
                document.getElementById('adminFields').style.display = 'block';
            } else if (selectedRole === 'seller') {
                document.getElementById('sellerFields').style.display = 'block';
            } else if (selectedRole === 'agent') {
                document.getElementById('agentFields').style.display = 'block';
            }
            
            // Update form validation requirements based on role
            updateValidationRequirements(selectedRole);
        }
        
        // Function to update validation requirements based on selected role
        function updateValidationRequirements(role) {
            // Reset all role-specific fields to not required
            const resetFields = document.querySelectorAll('.role-specific-fields input, .role-specific-fields select');
            resetFields.forEach(field => {
                field.required = false;
            });
            
            // Set required fields based on role
            if (role === 'admin') {
                document.getElementById('adminRole').required = true;
                document.getElementById('department').required = true;
            } else if (role === 'seller') {
                document.getElementById('businessName').required = true;
                document.getElementById('businessType').required = true;
                document.getElementById('taxId').required = true;
            } else if (role === 'agent') {
                document.getElementById('nationalId').required = true;
                document.getElementById('zone').required = true;
                document.getElementById('vehicleType').required = true;
            }
        }
    </script>
</body>
</html> 